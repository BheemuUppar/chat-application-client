<div class="bg-transparent d-flex flex-column h-100" *ngIf="currentChat">
    <nav class="d-flex p-4">
        <div class="userInfo d-flex gap-3 align-items-center" (click)="showContactInfo()">
            <div class="profile_img " [ngClass]="getOnlineStatusClass(currentChat.contact_id)">
                <img [src]="currentChat.profile_path" appDefaultImage alt="">
            </div>
            <div>
                <h5 class="mb-0" style="color: #FFFFFF;">{{currentChat.contact_name
                    }}</h5>
                <small style="color: #717174;">{{userService.isOnline(currentChat.contact_id) == true ? 'Active Now' :
                    'Last Seen '+dateService.formatDate(currentChat.contact_last_seen)}} </small>
            </div>
        </div>
        <div class="options">

        </div>
    </nav>
    <!-- <div id="messages" class="messages flex-grow-1" *ngIf="messageFiles.length == 0">
        <div *ngFor="let msg of messages" class="message-container">
            <div [ngClass]="msg.sender_id == user.user_id ? 'sentMessage' : 'receiveMessage'">
                <div class="content">
                    <span *ngIf="msg.message_file && msg.file_type == 'application/pdf'" class="file_msg">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="file_icon">
                            <path fill="#e61919" d="M0 64C0 28.7 28.7 0 64 0L224 0l0 128c0 17.7 14.3 32 32 32l128 0 0 144-208 0c-35.3 0-64 28.7-64 64l0 144-48 0c-35.3 0-64-28.7-64-64L0 64zm384 64l-128 0L256 0 384 128zM176 352l32 0c30.9 0 56 25.1 56 56s-25.1 56-56 56l-16 0 0 32c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-48 0-80c0-8.8 7.2-16 16-16zm32 80c13.3 0 24-10.7 24-24s-10.7-24-24-24l-16 0 0 48 16 0zm96-80l32 0c26.5 0 48 21.5 48 48l0 64c0 26.5-21.5 48-48 48l-32 0c-8.8 0-16-7.2-16-16l0-128c0-8.8 7.2-16 16-16zm32 128c8.8 0 16-7.2 16-16l0-64c0-8.8-7.2-16-16-16l-16 0 0 96 16 0zm80-112c0-8.8 7.2-16 16-16l48 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-32 0 0 32 32 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-32 0 0 48c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-64 0-64z"/>
                        </svg>
                        <p class="file_name">{{msg.file_name}}</p>
                    </span>
                    <span *ngIf="msg.message_file && msg.file_type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'" class="file_msg">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="#FFF" stroke-miterlimit="10" stroke-width="2" viewBox="0 0 96 96" class="file_icon">
                            <path stroke="#979593" d="M67.1716 7H27c-1.1046 0-2 .8954-2 2v78c0 1.1046.8954 2 2 2h58c1.1046 0 2-.8954 2-2V26.8284c0-.5304-.2107-1.0391-.5858-1.4142L68.5858 7.5858C68.2107 7.2107 67.702 7 67.1716 7z"/>
                            <path fill="none" stroke="#979593" d="M67 7v18c0 1.1046.8954 2 2 2h18"/>
                            <path fill="#C8C6C4" d="M79 61H48v-2h31c.5523 0 1 .4477 1 1s-.4477 1-1 1zm0-6H48v-2h31c.5523 0 1 .4477 1 1s-.4477 1-1 1zm0-6H48v-2h31c.5523 0 1 .4477 1 1s-.4477 1-1 1zm0-6H48v-2h31c.5523 0 1 .4477 1 1s-.4477 1-1 1zm0 24H48v-2h31c.5523 0 1 .4477 1 1s-.4477 1-1 1z"/>
                            <path fill="#185ABD" d="M12 74h32c2.2091 0 4-1.7909 4-4V38c0-2.2091-1.7909-4-4-4H12c-2.2091 0-4 1.7909-4 4v32c0 2.2091 1.7909 4 4 4z"/>
                            <path d="M21.6245 60.6455c.0661.522.109.9769.1296 1.3657h.0762c.0306-.3685.0889-.8129.1751-1.3349.0862-.5211.1703-.961.2517-1.319L25.7911 44h4.5702l3.6562 15.1272c.183.7468.3353 1.6973.457 2.8532h.0608c.0508-.7979.1777-1.7184.3809-2.7615L37.8413 44H42l-5.1183 22h-4.86l-3.4885-14.5744c-.1016-.4197-.2158-.9663-.3428-1.6417-.127-.6745-.2057-1.1656-.236-1.4724h-.0608c-.0407.358-.1195.8896-.2364 1.595-.1169.7062-.211 1.2273-.2819 1.565L24.1 66h-4.9357L14 44h4.2349l3.1843 15.3882c.0709.3165.1392.7362.2053 1.2573z"/>
                        </svg>
                        <p class="file_name">{{msg.file_name}}</p>
                    </span>
                    <div class="msgImage" *ngIf="msg.message_file && (msg.file_type == 'image/jpeg' || msg.file_type == 'image/png' )"> 
                        <img [src]="msg.message_file" alt="">
                    </div>
                    <p class="message_text">{{msg.message_text}}</p>
                </div>
                <div class="sm-profile">
                    <img [src]="getChatProfile(msg.sender_id)" appDefaultImage alt="">
                </div>
            </div>
            <p class="msg_time">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor" class="time_icon">
                    <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120l0 136c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2 280 120c0-13.3-10.7-24-24-24s-24 10.7-24 24z"/>
                </svg> {{dateService.formatDate(msg.sent_at)}}
            </p>
        </div>
    </div> -->

    <div class="chat-content p-2 messages flex-grow-1" id="messageBody">
        <div class="container">
    
          <!-- Message Day Start -->
          <div class="message-day">
            <!-- Received Message Start -->
            <div *ngFor="let msg of messages" class="message" [ngClass]="{'self':msg.sender_id == user.user_id }">
              <div class="message-wrapper">
                <div class="message-content" *ngIf="msg.message_text != null && msg.message_file == null">
                  <span>{{msg.message_text}}</span>
                </div>
                <div class="message-content" *ngIf="msg.message_file && msg.file_type != 'png' && msg.file_type !='jpg'  && msg.file_type !='jpeg' " >
                    <div class="document" >
                      <div class="btn btn-primary btn-icon rounded-circle text-light mr-2" (click)="downloadFile(msg.message_file, msg.file_name, msg.mime_type )">
                        <!-- Default :: Inline SVG -->
                        <svg class="hw-24" fill="none" viewBox="0 0 24 24" stroke="currentColor" *ngIf="msg.file_type == 'doc' || msg.file_type == 'docx'">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z">
                          </path>
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="hw-24" *ngIf="msg.file_type == 'pdf'">
                            <path fill="#e61919" d="M0 64C0 28.7 28.7 0 64 0L224 0l0 128c0 17.7 14.3 32 32 32l128 0 0 144-208 0c-35.3 0-64 28.7-64 64l0 144-48 0c-35.3 0-64-28.7-64-64L0 64zm384 64l-128 0L256 0 384 128zM176 352l32 0c30.9 0 56 25.1 56 56s-25.1 56-56 56l-16 0 0 32c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-48 0-80c0-8.8 7.2-16 16-16zm32 80c13.3 0 24-10.7 24-24s-10.7-24-24-24l-16 0 0 48 16 0zm96-80l32 0c26.5 0 48 21.5 48 48l0 64c0 26.5-21.5 48-48 48l-32 0c-8.8 0-16-7.2-16-16l0-128c0-8.8 7.2-16 16-16zm32 128c8.8 0 16-7.2 16-16l0-64c0-8.8-7.2-16-16-16l-16 0 0 96 16 0zm80-112c0-8.8 7.2-16 16-16l48 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-32 0 0 32 32 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-32 0 0 48c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-64 0-64z"/>
                        </svg>
      
                       
                      </div>
      
                      <div class="document-body">
                        <h6>
                          <a href="#s" class="text-reset"
                            [title]="msg.file_name" (click)="downloadFile(msg.message_file, msg.file_name, msg.mime_type )">{{msg.file_name}}</a>
                        </h6>
      
                        <ul class="list-inline small mb-0">
                          <li class="list-inline-item">
                            <span class="text-muted">{{formatBytes(msg.file_size)}}</span>
                          </li>
                          <li class="list-inline-item">
                            <span class="text-muted text-uppercase">{{msg.file_type}}</span>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  
                  <div class="message-content msg_image" *ngIf="msg.message_file && msg.file_type == 'png' || msg.file_type =='jpg'  || msg.file_type =='jpeg' " >
                    <div class="document" >
                     <div class="document-body">
                        <img [src]="msg.message_file" alt="">
                      </div>
                    </div>
                  </div>
              </div>
              <div class="message-options">
                <div class="avatar avatar-sm">
                    <img [src]="getChatProfile(msg.sender_id)" appDefaultImage alt=""></div>
                <span class="message-date">{{dateService.formatDate(msg.sent_at)}}</span>
                <div class="dropdown">
                  <a class="text-muted" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <svg class="hw-18" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z">
                      </path>
                    </svg>
    
                  </a>
    
                  <div class="dropdown-menu">
                    <a class="dropdown-item d-flex align-items-center" href="#">
                      <!-- Default :: Inline SVG -->
                      <svg class="hw-18 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
                        </path>
                      </svg>
    
                      <!-- Alternate :: External File link -->
                      <!-- <img class="injectable hw-18 mr-2" src="./../../assets/media/heroicons/outline/duplicate.svg" alt="message options"> -->
                      <span>Copy</span>
                    </a>
                    <a class="dropdown-item d-flex align-items-center" href="#">
                      <!-- Default :: Inline SVG -->
                      <svg class="hw-18 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path>
                      </svg>
    
                      <!-- Alternate :: External File link -->
                      <!-- <img class="injectable hw-18 mr-2" src="./../../assets/media/heroicons/outline/reply.svg" alt="message replay"> -->
                      <span>Replay</span>
                    </a>
                    <a class="dropdown-item d-flex align-items-center" href="#">
                      <!-- Default :: Inline SVG -->
                      <svg class="hw-18 rotate-y mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path>
                      </svg>
    
                      <!-- Alternate :: External File link -->
                      <!-- <img class="injectable rotate-y hw-18 mr-2" src="./../../assets/media/heroicons/outline/reply.svg" alt="message forward"> -->
                      <span>Forward</span>
                    </a>
                    <a class="dropdown-item d-flex align-items-center" href="#">
                      <!-- Default :: Inline SVG -->
                      <svg class="hw-18 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z">
                        </path>
                      </svg>
    
                      <!-- Alternate :: External File link -->
                      <!-- <img class="injectable hw-18 mr-2" src="./../../assets/media/heroicons/outline/star.svg" alt="message favourite"> -->
                      <span>Favourite</span>
                    </a>
                    <a class="dropdown-item d-flex align-items-center text-danger" href="#">
                      <!-- Default :: Inline SVG -->
                      <svg class="hw-18 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                        </path>
                      </svg>
    
                      <!-- Alternate :: External File link -->
                      <!-- <img class="injectable hw-18 mr-2" src="./../../assets/media/heroicons/outline/trash.svg" alt="message delete"> -->
                      <span>Delete</span>
                    </a>
                  </div>
                </div>
              </div>
            </div>
            <!-- Received Message End -->
    
           
    
           
    
           
    
          
        </div>
      </div>
      </div>
    <div class="inputs position-relative " [ngClass]="{'flex-grow-1 d-flex flex-column':  messageFiles.length > 0}">
        <div class="flex-grow-1 p-5 text-white"  *ngIf="messageFiles.length > 0">
            <button class="btn  text-white p-0" (click)="resetSelectedFiles()" style="position: absolute; right: 0; top: 0;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor">
                    <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                    <path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z"/>
                </svg>
            </button>
            <p class="text-center"> {{messageFiles[0].name}}</p>
           <div *ngIf="messageFiles[0].type == 'image/png'">
           <div class="d-flex flex-column align-items-center">
            <img [src]="imageLink" alt="" style="height: 39vh;">
           </div>
           </div>
           <div *ngIf="messageFiles[0].type != 'image/png'">
            <span class="d-flex flex-column align-items-center">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" style="height:39vh; width:50vw" fill="currentColor">
                    <path d="M320 464c8.8 0 16-7.2 16-16l0-288-80 0c-17.7 0-32-14.3-32-32l0-80L64 48c-8.8 0-16 7.2-16 16l0 384c0 8.8 7.2 16 16 16l256 0zM0 64C0 28.7 28.7 0 64 0L229.5 0c17 0 33.3 6.7 45.3 18.7l90.5 90.5c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64z"/>
                </svg>
                <h3 class="mt-3 text-center ">No Preview Available</h3>
            </span>
           </div>
        </div>

        <div class="input-container d-flex align-items-center gap-4">
            <span style="cursor: pointer;" (click)="fileUpload()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" fill="currentColor">
                    <path
                        d="M364.2 83.8c-24.4-24.4-64-24.4-88.4 0l-184 184c-42.1 42.1-42.1 110.3 0 152.4s110.3 42.1 152.4 0l152-152c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-152 152c-64 64-167.6 64-231.6 0s-64-167.6 0-231.6l184-184c46.3-46.3 121.3-46.3 167.6 0s46.3 121.3 0 167.6l-176 176c-28.6 28.6-75 28.6-103.6 0s-28.6-75 0-103.6l144-144c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-144 144c-6.7 6.7-6.7 17.7 0 24.4s17.7 6.7 24.4 0l176-176c24.4-24.4 24.4-64 0-88.4z" />
                </svg>
            </span>

            <input type="text" class="p-3 flex-grow-1" placeholder="Type a message" name="message_text"
                (keypress)="onEnterPress($event)" [(ngModel)]="message_text">
            <button type="button" class="send-btn" (click)="sendMessage()">
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                    viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                    <path
                        d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480l0-83.6c0-4 1.5-7.8 4.2-10.8L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z" />
                </svg>
            </button>
        </div>
       
    </div>
</div>